var MyLib;(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{clearOptions:()=>c,currentOptions:()=>a,displayedGeo:()=>r,endDate:()=>u,geonamesApi:()=>i,keysInfo:()=>o,newOptions:()=>s,pixCall:()=>w,postData:()=>n,returnGeo:()=>l,startDate:()=>d,submitFunction:()=>g,weatherCall:()=>m,weatherbit:()=>y});const n=async(e=" ",t={})=>{const n=await fetch(e,{method:"POST",mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json"},redirect:"follow",referrerPolicy:"no-referrer",body:JSON.stringify(t)});try{return await n.json()}catch(e){console.log("eror",e)}};async function o(){let e=await fetch("http://localhost:3080/keyData");try{return await e.json()}catch(e){console.log("error",e)}}let a=[],s={};const l=()=>{document.getElementById("search").addEventListener("click",(()=>{MyLib.clearOptions(),MyLib.keysInfo().then((e=>MyLib.geonamesApi(e.geonames,e.geoUrl)))}))},i=async(e,t)=>{let n=document.getElementById("destination");a=[];const o=await fetch(t+n.value+"&maxRows=20&username="+e);try{const e=await o.json();console.log(e),console.log(e.geonames);for(let t=0;t<e.geonames.length;t++)s={key:t,place:Object.values(e.geonames[t].toponymName).join(""),state:Object.values(e.geonames[t].adminName1).join(""),country:Object.values(e.geonames[t].countryName).join(""),lat:Object.values(e.geonames[t].lat).join(""),long:Object.values(e.geonames[t].lng).join("")},a.push(s);r(a)}catch(e){alert("Please type a more specific location and try again."),console.log("error",e)}},r=e=>{const t=document.createElement("select");document.getElementById("select_location").appendChild(t);let n=document.createElement("option");n.textContent="Please choose from one of the following...",t.appendChild(n);for(let n=0;n<e.length;n++){let o=n+1,a="Location: "+Object.values(e[n].place).join("").toUpperCase(),s="State: "+Object.values(e[n].state).join("").toUpperCase(),l="Country: "+Object.values(e[n].country).join("").toUpperCase(),i=document.createElement("option");i.textContent=o+". "+a+"  "+s+"  "+l,t.appendChild(i)}t.addEventListener("change",(e=>{let t=Object.values(e.target.value).join(""),n=0,o=[];for(;parseInt(t[n]);)o.push(t[n]),n++;let l=a[o.join("")-1];s.key=l.key,s.place=l.place,s.state=l.state,s.country=l.country,s.lat=l.lat,s.long=l.long,a=[],a.push(s),p()}))},c=()=>{const e=document.querySelector("select");if(e){e.remove();document.getElementById("date_input").style.display="none"}},p=()=>{const e=document.getElementById("date_input");"none"===e.style.display&&(e.style.display="flex")},y=async(e,t,n,o,a,s)=>{const l=await fetch(t+n+","+o+"/"+a+"/"+s+"?key="+e);try{const e=await l.json();return console.log("weather",e),e}catch(e){console.log("error",e)}},d=e=>{let t=document.getElementById(e);MyLib.newOptions.startMonth=t.value[5]+t.value[6],MyLib.newOptions.startDay=t.value[8]+t.value[9],MyLib.newOptions.startDate=t.value,console.log(t.value)},u=e=>{let t=document.getElementById(e);MyLib.newOptions.endMonth=t.value[5]+t.value[6],MyLib.newOptions.endDay=t.value[8]+t.value[9],MyLib.newOptions.endDate=t.value,console.log(t.value)},m=()=>{MyLib.startDate("start_date"),MyLib.endDate("end_date"),MyLib.keysInfo().then((e=>MyLib.weatherbit(e.visCrossKey,e.visCrossUrl,MyLib.newOptions.lat,MyLib.newOptions.long,MyLib.newOptions.startDate,MyLib.newOptions.endDate))).then((e=>b("tempmax","tempmin","precip","snow","datetime","clouds",e.days))).then((e=>h("month","day","highTemp","lowTemp","precip","snow",e.weatherInfo))),console.log(MyLib.newOptions)},b=(e,t,n,o,a,s,l)=>{MyLib.newOptions.weatherInfo=[];for(let i=0;i<l.length;i++){let r=l[i],c={highTemp:r[e],lowTemp:r[t],precip:r[n],clouds:r[s],snow:r[o],date:r[a],month:r[a][5]+r[a][6],day:r[a][8]+r[a][9]};MyLib.newOptions.weatherInfo.push(c)}return MyLib.currentOptions.push(MyLib.newOptions),MyLib.currentOptions.splice(1),console.log(MyLib.newOptions),console.log(MyLib.currentOptions),MyLib.newOptions},h=(e,t,n,o,a,s,l)=>{const i=document.getElementById("weather");for(let r=0;r<l.length;r++){const c=document.createElement("card"),p=document.createElement("h2");p.textContent=l[r][e]+"/"+l[r][t],c.appendChild(p);const y=document.createElement("img");parseFloat(l[r][a])>.1&&0===l[r][s]?y.setAttribute("src","/src/client/assets/rain_clipartLibrary.jpeg"):parseFloat(l[r][a])<.1&&parseFloat(l[r][a]>.01)&&0===parseFloat(l[r][s])?y.setAttribute("src","src/client/assets/cloudy_clipArtLibrary.jpeg"):parseFloat(l[r][s])>0?y.setAttribute("src","src/client/assets/snow_clipartLibrary.jpeg"):y.setAttribute("src","src/client/assets/sunny_clipartLibrary.jpeg"),c.appendChild(y);const d=document.createElement("p");d.textContent="High of: "+l[r][n],c.appendChild(d);const u=document.createElement("p");u.textContent="Low of "+l[r][o],c.appendChild(u),i.appendChild(c)}},g=()=>{document.getElementById("submit").addEventListener("click",(e=>{e.preventDefault(),Promise.all([MyLib.weatherCall(),MyLib.pixCall()]).then((()=>MyLib.postData("/allCurrentData",{data:MyLib.currentOptions})))}))},w=()=>{MyLib.keysInfo().then((e=>L(e.pixabay,e.pixabayUrl,[MyLib.newOptions.place,MyLib.newOptions.state,MyLib.newOptions.Country]))).then((e=>O(e,"totalHits","hits","fullHDURL")))},L=async(e,t,n)=>{let o="";o=1===n.length?n.toString():n.join("+").toString(),console.log(n.length),console.log(t+e+"&q="+o+"&image_type=photo");const a=await fetch(t+e+"&q="+n+"&image_type=photo");try{let e=await a.json();return console.log(e),e}catch(e){console.log("error",e)}},O=(e,t,n,o)=>{e[t]>0?M(e[n][0][o]):MyLib.keysInfo().then((e=>L(e.pixabay,e.pixabayUrl,[MyLib.newOptions.country]))).then((e=>M(e.hits[3].fullHDURL)))},M=e=>{MyLib.newOptions.picUrl=e,(e=>{const t=document.getElementById("location_pic"),n=document.createElement("img");n.setAttribute("src",e),n.setAttribute("id","pixabay_pic"),t.appendChild(n)})(e)};MyLib=t})();